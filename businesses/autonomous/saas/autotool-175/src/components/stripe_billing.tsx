# Generate the Stripe billing component code
write(
    content="// src/components/StripeBilling.tsx\nimport React, { useState, useEffect } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\n\nconst stripePromise = loadStripe(process.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY);\n\ninterface StripeBillingProps {\n  customerId: string;\n}\n\nexport default function StripeBilling({ customerId }: StripeBillingProps) {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    // Fetch customer data or subscription status here\n    // Example: Check if the customer has an active subscription\n  }, [customerId]);\n\n  const handleCheckout = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const stripe = await stripePromise;\n      if (!stripe) {\n        throw new Error('Stripe failed to load.');\n      }\n\n      const response = await fetch('/api/create-checkout-session', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ customerId }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to create checkout session.');\n      }\n\n      const session = await response.json();\n\n      // Redirect to Stripe Checkout\n      const result = await stripe.redirectToCheckout({\n        sessionId: session.id,\n      });\n\n      if (result.error) {\n        throw new Error(result.error.message);\n      }\n    } catch (e: any) {\n      console.error('Stripe checkout error:', e);\n      setError(e.message || 'An unexpected error occurred.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      {error && <div style={{ color: 'red' }}>Error: {error}</div>}\n      {loading ? (\n        <p>Loading...</p>\n      ) : (\n        <button onClick={handleCheckout} disabled={loading}>\n          Subscribe\n        </button>\n      )}\n    </div>\n  );\n}\n",
    file_path="src/components/StripeBilling.tsx"
)